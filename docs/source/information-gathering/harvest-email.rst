.. _harvest-email:

Email Harvesting (theHarvester)
===============================
theHarvester_ is a tool that can be used by penetration testers for gathering information from different public sources like search engines, PGP key servers, and SHODAN computer database, such as:

- emails
- sub-domains
- hosts
- employee names
- open ports
- banners

This tool can be used in passive reconnaissance and by anyone who needs to know what an attacker can see about the organization.

Usage
-----

.. code-block:: console

    theHarvester -d [DOMAIN] -b [SOURCE]

Example
-------

To harvest ``gmail.com`` emails and web domains from Google:

.. code-block:: console

    theHarvester -d gmail.com -b google

.. code-block:: console

    > theHarvester -d gmail.com -b google

    *******************************************************************
    *  _   _                                            _             *
    * | |_| |__   ___    /\  /\__ _ _ ____   _____  ___| |_ ___ _ __  *
    * | __|  _ \ / _ \  / /_/ / _` | '__\ \ / / _ \/ __| __/ _ \ '__| *
    * | |_| | | |  __/ / __  / (_| | |   \ V /  __/\__ \ ||  __/ |    *
    *  \__|_| |_|\___| \/ /_/ \__,_|_|    \_/ \___||___/\__\___|_|    *
    *                                                                 *
    * theHarvester 4.0.3                                              *
    * Coded by Christian Martorella                                   *
    * Edge-Security Research                                          *
    * cmartorella@edge-security.com                                   *
    *                                                                 *
    *******************************************************************


    [*] Target: gmail.com

            Searching 0 results.
            Searching 100 results.
            Searching 200 results.
            Searching 300 results.
            Searching 400 results.
            Searching 500 results.
    [*] Searching Google.

    [*] No IPs found.

    [*] Emails found: 145
    ----------------------
    xxxxx@gmail.com
    xxxxx@gmail.com
    xxxxx@gmail.com
    xxxxx@gmail.com
    xxxxx@gmail.com
    [...]

    [*] Hosts found: 8
    ---------------------
    xxx.gmail.com
    xxx.gmail.com
    xxx.gmail.com
    xxx.gmail.com
    xxx.gmail.com
    [...]

.. note::

    The results above are censored in order to respect the domain owners' privacy.

Arguments
---------
-h, --help
~~~~~~~~~~
    show this help message and exit

-d DOMAIN, --domain <*DOMAIN*>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Company name or domain to search.

-l <*LIMIT*>, --limit <*LIMIT*>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Limit the number of search results, default ``500``.

-S <*X*>, --start <*X*>
~~~~~~~~~~~~~~~~~~~~~~~
    Start with result number ``X``, default ``0``.

-g, --google-dork
~~~~~~~~~~~~~~~~~
    Use Google Dorks for Google search.

-p, --proxies
~~~~~~~~~~~~~
    Use proxies for requests, enter proxies in ``proxies.yaml``.

-s, --shodan
~~~~~~~~~~~~
    Use Shodan to query discovered hosts.

--screenshot <*SCREENSHOT*>
~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Take screenshots of resolved domains specify output directory: ``--screenshot output_directory``

-v, --virtual-host
~~~~~~~~~~~~~~~~~~
    Verify host name via DNS resolution and search for virtual hosts.

-e <*DNS_SERVER*>, --dns-server <*DNS_SERVER*>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    DNS server to use for lookup.

-t <*DNS_TLD*>, --dns-tld <*DNS_TLD*>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Perform a DNS TLD expansion discovery, default ``False``.

-r, --take-over
~~~~~~~~~~~~~~~
    Check for takeovers.

-n, --dns-lookup
~~~~~~~~~~~~~~~~
    Enable DNS server lookup, default ``False``.

-c, --dns-brute
~~~~~~~~~~~~~~~
    Perform a DNS brute force on the domain.

-f <*FILENAME*>, --filename <*FILENAME*>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Save the results to an ``XML`` and ``JSON`` file.

-b <*SOURCE*>, --source <*SOURCE*>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    =========== ============    ==============  ================
    
    =========== ============    ==============  ================
    anubis      baidu           bing            binaryedge
    bingapi     bufferoverun    censys          certspotter
    crtsh       dnsdumpster     duckduckgo      fullhunt
    github-code google          hackertarget    hunter
    intelx      linkedin        linkedin_links  n45ht
    omnisint    otx             pentesttools    projectdiscovery
    qwant       rapiddns        rocketreach     securityTrails
    spyse       sublist3r       threatcrowd     threatminer
    trello      twitter         urlscan         virustotal
    yahoo       zoomeye
    =========== ============    ==============  ================

    .. note::
        
        Sources can be added or removed in the future

.. _theHarvester: https://www.kali.org/tools/theharvester/